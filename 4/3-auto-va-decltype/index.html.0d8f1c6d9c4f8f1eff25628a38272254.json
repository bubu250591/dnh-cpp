{"head":{"title":"4.3 auto và decltype","route":"4/3-auto-va-decltype","id":30020,"description":"// compare the type of n with type int32_t if (typeid(int32_t) == typeid(n)) \tcout &lt;&lt; \"n is an object of type int32_t\" &lt;&lt; endl;…"},"body":"<html><head></head><body><h4>Hi everyone! Rất vui khi được gặp lại mọi người trong bài học tiếp theo của khóa học lập trình trực tuyến ngôn ngữ C++.</h4>\n\n<p>Trong bài học hôm nay, chúng ta làm quen với một số khái niệm mới được cung cấp bởi chuẩn <strong>C++11</strong> khi làm việc về kiểu dữ liệu.</p>\n\n<p>Nhưng trước hết, mình muốn giới thiệu với các bạn 1 thư viện trong Visual studio 2015, nó sẽ hổ trợ cho chúng ta xem thông tin về kiểu dữ liệu của một đối tượng ta đang xem xét.</p>\n\n<h3>Thư viện typeinfo</h3>\n\n<p>Thư viện này định nghĩa 1 <strong>class</strong> (các bạn sẽ được học về class trong phần lập trình hướng đối tượng với C++) có tên là <strong>type_info</strong>, <strong>class</strong> này giữ thông tin về kiểu dữ liệu của đối tượng đang được xem xét. </p>\n\n<p>Sử dụng thư viện <strong>typeinfo</strong> chúng ta có thể thực hiện phép so sánh <strong>==</strong> hoặc <strong>!=</strong> giữa hai đối tượng để kiểm tra chúng có cùng hay khác kiểu dữ liệu.</p>\n\n<p>Chúng ta còn có thể lấy ra thông tin về kiểu dữ liệu của đối tượng thông qua toán tử <strong>typeid</strong>. Hoặc sử dụng phương thức <strong>name</strong> định nghĩa bên trong class <strong>type_info</strong> để lấy ra tên của kiểu dữ liệu của đối tượng.</p>\n\n<pre><code class=\"hljs language-cs\"><span class=\"hljs-keyword\">namespace</span> <span class=\"hljs-title\">std</span>\t{\n\t...\n\t<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">type_info</span>;\n\t<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">bad_cast</span>;\n\t<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">bad_typeid</span>;\n\t...\n}</code></pre>\n\n<p>Vì class <strong>type_info</strong> được định nghĩa trong <strong>namespace std</strong> nên chúng ta cũng nên khai báo <strong>using namespace std</strong> trước khi sử dụng.</p>\n\n<p>Một ví dụ về việc sử dụng thư viện <strong>typeinfo</strong>:</p>\n\n<ul><li>\n<p>Sử dụng toán tử <strong>==</strong> và <strong>!=</strong> trong class <strong>type_info</strong>:</p>\n<pre><code class=\"hljs language-cpp\"><span class=\"hljs-keyword\">int</span> n;\n\n<span class=\"hljs-comment\">// compare the type of n with type int32_t</span>\n<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">typeid</span>(<span class=\"hljs-keyword\">int32_t</span>) == <span class=\"hljs-keyword\">typeid</span>(n))\n\t<span class=\"hljs-built_in\">cout</span> &#x3C;&#x3C; <span class=\"hljs-string\">\"n is an object of type int32_t\"</span> &#x3C;&#x3C; <span class=\"hljs-built_in\">endl</span>;\n\n<span class=\"hljs-comment\">// compare the type of n with type float</span>\n<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">typeid</span>(<span class=\"hljs-keyword\">float</span>) != <span class=\"hljs-keyword\">typeid</span>(n))\n\t<span class=\"hljs-built_in\">cout</span> &#x3C;&#x3C; <span class=\"hljs-string\">\"n is not an object of type float\"</span> &#x3C;&#x3C; <span class=\"hljs-built_in\">endl</span>;</code></pre>\n</li></ul>\n\n<p>Các bạn thử chạy lại đoạn code mẫu trên để tự mình xem kết quả.</p>\n\n<ul><li>\n<p>Lấy ra tên kiểu dữ liệu của một đối tượng cụ thể:</p>\n<pre><code class=\"hljs language-cpp\"><span class=\"hljs-keyword\">int64_t</span> i_value;\n<span class=\"hljs-keyword\">float</span>\tf_value;\n\n<span class=\"hljs-built_in\">cout</span> &#x3C;&#x3C; <span class=\"hljs-string\">\"Type of i_value is \"</span> &#x3C;&#x3C; <span class=\"hljs-keyword\">typeid</span>(i_value).name() &#x3C;&#x3C; <span class=\"hljs-built_in\">endl</span>;\n<span class=\"hljs-built_in\">cout</span> &#x3C;&#x3C; <span class=\"hljs-string\">\"Type of f_value is \"</span> &#x3C;&#x3C; <span class=\"hljs-keyword\">typeid</span>(f_value).name() &#x3C;&#x3C; <span class=\"hljs-built_in\">endl</span>;</code></pre>\n</li></ul>\n\n<p>Toán tử <strong>typeid</strong> nhận vào một đối tượng (có thể là 1 biến), ví dụ <code>typeid(i_value)</code>, toán tử <strong>typeid</strong> khi sử dụng sẽ trả về một đối tượng kiểu <strong>type_info</strong>. Chúng ta sử dụng dấu chấm để gọi ra phương thức <strong>name</strong> được định nghĩa bên trong kiểu <strong>type_info</strong>, phương thức <strong>name</strong> trả về 1 chuỗi kí tự là tên kiểu dữ liệu của đối tượng chúng ta đưa vào.</p>\n\n<pre><code class=\"hljs language-excel\">typeid(i_value).name(); //Có thể sử dụng đối <span class=\"hljs-built_in\">t</span>ượng cout để in <span class=\"hljs-built_in\">t</span>ê<span class=\"hljs-built_in\">n</span> của i_value lê<span class=\"hljs-built_in\">n</span> mà<span class=\"hljs-built_in\">n</span> hình</code></pre>\n\n<p><em>Trong bài này, mình chỉ mới sử dụng thư viện <strong>typeinfo</strong> cho các kiểu dữ liệu cơ bản, một số thứ khác mình sẽ đề cập đến trong phần lập trình hướng đối tượng với C++.</em></p>\n\n<h3>Từ khóa auto (auto keyword)</h3>\n\n<p>Các bạn cùng nhìn lại cách thông thường mà chúng ta khai báo biến.</p>\n\n<pre><code class=\"hljs language-xml\"><span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">data_type</span>></span> <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">name_of_variable</span>></span> [= <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">original</span> <span class=\"hljs-attr\">value</span>></span>];</code></pre>\n\n<p>Dựa trên cú pháp khai báo biến này, lập trình viên phải xác định trước được kiểu dữ liệu cần sử dụng để lưu trữ giá trị.</p>\n\n<p>Với chuẩn C++11 ra đời, <strong>compiler</strong> có thể thay bạn quyết định kiểu dữ liệu cho giá trị mà bạn muốn sử dụng bằng cách sử dụng từ khóa <strong>auto</strong>.</p>\n\n<p>Cách sử dụng từ khóa <strong>auto</strong>:</p>\n\n<pre><code class=\"hljs language-xml\">auto <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">variable_name</span>></span> = <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">expression</span>></span>;</code></pre>\n\n<p>Giá trị khởi tạo là thành phần bắt buộc phải có khi sử dụng từ khóa <strong>auto</strong>, <strong>compiler</strong> sẽ dựa trên giá trị khởi tạo để quyết định kiểu dữ liệu nào phù hợp với biến (có thể là 1 con số, 1 kí tự, 1 chuỗi kí tự, hoặc 1 biểu thức toán học...).</p>\n\n<pre><code class=\"hljs language-cpp\"><span class=\"hljs-keyword\">auto</span> x = <span class=\"hljs-number\">0</span>;\n<span class=\"hljs-keyword\">auto</span> max_of_int64 = INT64_MAX;\n<span class=\"hljs-keyword\">auto</span> PI = <span class=\"hljs-number\">3.14</span>;\n<span class=\"hljs-keyword\">auto</span> character = <span class=\"hljs-string\">'V'</span>;\n<span class=\"hljs-keyword\">auto</span> my_name = <span class=\"hljs-string\">\"Le Tran Dat\"</span>;</code></pre>\n\n<p>Chúng ta cùng thử dùng thư viện <strong>typeinfo</strong> mà mình đã giới thiệu ở trên để xem từ khóa <strong>auto</strong> đã chọn kiểu dữ liệu gì cho từng biến.</p>\n\n<pre><code class=\"hljs language-elm\"><span class=\"hljs-title\">cout</span> &#x3C;&#x3C; <span class=\"hljs-string\">\"Type of x: \"</span> &#x3C;&#x3C; typeid(x).name() &#x3C;&#x3C; endl;\n<span class=\"hljs-title\">cout</span> &#x3C;&#x3C; <span class=\"hljs-string\">\"Type of max_of_int64: \"</span> &#x3C;&#x3C; typeid(max_of_int64).name() &#x3C;&#x3C; endl;\n<span class=\"hljs-title\">cout</span> &#x3C;&#x3C; <span class=\"hljs-string\">\"Type of PI: \"</span> &#x3C;&#x3C; typeid(<span class=\"hljs-type\">PI</span>).name() &#x3C;&#x3C; endl;\n<span class=\"hljs-title\">cout</span> &#x3C;&#x3C; <span class=\"hljs-string\">\"Type of character: \"</span> &#x3C;&#x3C; typeid(character).name() &#x3C;&#x3C; endl;\n<span class=\"hljs-title\">cout</span> &#x3C;&#x3C; <span class=\"hljs-string\">\"Type of my_name: \"</span> &#x3C;&#x3C; typeid(my_name).name() &#x3C;&#x3C; endl;</code></pre>\n\n<p>Bên dưới là kết quả chạy chương trình của mình.</p>\n\n<p><img src=\"https://raw.githubusercontent.com/nguyenchiemminhvu/CPP-Tutorial/master/4-nang-cao-ve-bien-va-kieu-du-lieu/4-3-auto-keyword-and-decltype-keyword/0.png\" width=\"670\" height=\"332\"></p>\n\n<p><strong>Compiler</strong> đã chọn đúng kiểu dữ liệu cho từng biến, nhưng chưa phải là tối ưu nhất. Ví dụ với giá trị <strong>PI = 3.14</strong>, chúng ta hoàn toàn có thể lưu trữ với kiểu dữ liệu <strong>float (4 bytes)</strong> thay vì kiểu <strong>double (8 bytes)</strong>. Nhưng vì <strong>compiler</strong> muốn đảm bảo an toàn cho dữ liệu, nên nó đã chọn kiểu có kích thước lớn hơn để đề phòng giá trị biến <strong>PI</strong> có thể bị thay đổi.</p>\n\n<p><em>Trong bài học này, mình chỉ mới hướng dẫn các bạn sử dụng từ khóa <strong>auto</strong> để làm việc với các kiểu dữ liệu cơ bản. Từ khóa <strong>auto</strong> còn có thể dùng để tự nhận dạng các kiểu dữ liệu mà chúng ta tự định nghĩa, kiểu con trỏ, các iterator trong bộ thư viện STL,... Vì thế, mình sẽ còn nhắc lại từ khóa <strong>auto</strong> trong những bài học sau.</em></p>\n\n<h3>Từ khóa <strong>decltype</strong> (decltype keyword)</h3>\n\n<p>Cũng tương tự với từ khóa <strong>auto</strong>, từ khóa <strong>decltype</strong> giúp chương trình tự động xác định kiểu dữ liệu cho biến. Nhưng cách sử dụng từ khóa <strong>decltype</strong> có một chút khác biệt so với cách sử dụng từ khóa <strong>auto</strong>.</p>\n\n<p>Để phân biệt:</p>\n\n<ul>\n<li>Từ khóa <strong>auto</strong> xác định kiểu dữ liệu dựa trên phần khởi tạo của biến.</li>\n<li>Từ khóa <strong>decltype</strong> xác định kiểu dữ liệu từ 1 biến hoặc 1 biểu thức khác.</li>\n</ul>\n\n<p>Vì thế, khi sử dụng từ khóa <strong>decltype</strong>, chúng ta phải sử dụng kèm với 1 đối tượng cụ thể (1 biến, 1 biểu thức hoặc 1 đối tượng của class nào đó...).</p>\n\n<p>Cách sử dụng từ khóa <strong>decltype</strong>:</p>\n\n<pre><code class=\"hljs language-xml\">decltype(<span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">object</span> <span class=\"hljs-attr\">or</span> <span class=\"hljs-attr\">expression</span>></span>) <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">variable_name</span>></span> [= <span class=\"hljs-tag\">&#x3C;<span class=\"hljs-name\">initial_value</span>></span>];</code></pre>\n\n<p>Giá trị khởi tạo (phần đặt trong ngoặc vuông) là không bắt buộc vì từ khóa <strong>decltype</strong> đã xác định được kiểu dữ liệu bằng cách lấy kiểu dữ liệu của đối tượng (object) hoặc biểu thức (expression).</p>\n\n<pre><code class=\"hljs language-ceylon\">int<span class=\"hljs-number\">32_</span>t i<span class=\"hljs-number\">_</span><span class=\"hljs-keyword\">value</span>;\ndecltype(i<span class=\"hljs-number\">_</span><span class=\"hljs-keyword\">value</span>) what<span class=\"hljs-number\">_</span><span class=\"hljs-keyword\">is</span><span class=\"hljs-number\">_</span><span class=\"hljs-keyword\">this</span>;\n\ncout &#x3C;&#x3C; typeid(what<span class=\"hljs-number\">_</span><span class=\"hljs-keyword\">is</span><span class=\"hljs-number\">_</span><span class=\"hljs-keyword\">this</span>).name() &#x3C;&#x3C; endl; <span class=\"hljs-comment\">//int</span></code></pre>\n\n<p>Trong đoạn chương trình trên, mình khai báo 1 biến có tên là <strong>i_value</strong> với kiểu dữ liệu <strong>int32_t</strong>. Sau đó, mình dùng từ khóa <strong>decltype</strong> để lấy ra kiểu dữ liệu của biến <strong>i_value</strong> và dùng nó cho biến mà mình muốn sử dụng.</p>\n\n<p>Thử so sánh kiểu dữ liệu của 2 biến:</p>\n\n<pre><code class=\"hljs language-cpp\"><span class=\"hljs-keyword\">int32_t</span> i_value;\n<span class=\"hljs-keyword\">decltype</span>(i_value) what_is_this;\n\n<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">typeid</span>(i_value) == <span class=\"hljs-keyword\">typeid</span>(what_is_this))\n\t<span class=\"hljs-built_in\">cout</span> &#x3C;&#x3C; <span class=\"hljs-string\">\"i_value and what_is_this have the same data type\"</span> &#x3C;&#x3C; <span class=\"hljs-built_in\">endl</span>;\n<span class=\"hljs-keyword\">else</span>\n\t<span class=\"hljs-built_in\">cout</span> &#x3C;&#x3C; <span class=\"hljs-string\">\"Are you kidding me?\"</span> &#x3C;&#x3C; <span class=\"hljs-built_in\">endl</span>;</code></pre>\n\n<p>Bởi vì từ khóa <strong>decltype</strong> lấy kiểu dữ liệu của đối tượng trước đó để khai báo cho đối tượng sau, nên hai đối tượng này luôn có cùng kiểu dữ liệu.</p>\n\n<h3>Kết hợp từ khóa auto và từ khóa decltype (C++14 standard)</h3>\n\n<p>Khi các bạn sử dụng <strong>Visual studio 2015</strong> thì sẽ được tích hợp luôn chuẩn C++14. Và các bạn có thể thực hiện khai báo như sau:</p>\n\n<pre><code class=\"hljs language-cpp\"><span class=\"hljs-keyword\">decltype</span>(<span class=\"hljs-keyword\">auto</span>) &#x3C;variable_name> = &#x3C;initial_value>;</code></pre>\n\n<p>Từ khóa <strong>decltype</strong> sẽ lấy ra kiểu dữ liệu mà từ khóa <strong>auto</strong> đã xác định được qua giá trị khởi tạo. Vì thế, giá trị khởi tạo là thành phần bắt buộc.</p>\n\n<pre><code class=\"hljs language-cpp\"><span class=\"hljs-keyword\">decltype</span>(<span class=\"hljs-keyword\">auto</span>) my_name = <span class=\"hljs-string\">\"Le Tran Dat\"</span>;\n<span class=\"hljs-built_in\">cout</span> &#x3C;&#x3C; <span class=\"hljs-string\">\"Type of my_name: \"</span> &#x3C;&#x3C; <span class=\"hljs-keyword\">typeid</span>(my_name).name() &#x3C;&#x3C; <span class=\"hljs-built_in\">endl</span>; <span class=\"hljs-comment\">//char const [12]</span></code></pre>\n\n<p>Qua đoạn code mẫu trên, <strong>compiler</strong> đã xác định được kiểu dữ liệu dùng cho biến <strong>my_name</strong> là chuỗi kí tự gồm 12 kí tự.</p>\n\n<p><strong><em>Lưu ý: cách dùng này chỉ được hổ trợ trong chuẩn C++14.</em></strong></p>\n\n<hr>\n\n<h3>Tổng kết</h3>\n\n<p>Sử dụng từ khóa <strong>auto</strong> và <strong>decltype</strong> giúp chương trình của chúng ta dễ hiểu hơn, nhưng cũng có một số hạn chế khi để <strong>compiler</strong> tự động quyết định kiểu dữ liệu. Ví dụ:</p>\n\n<pre><code class=\"hljs language-ceylon\">int i<span class=\"hljs-number\">_</span><span class=\"hljs-keyword\">value</span> = <span class=\"hljs-number\">10</span>;\nfloat f<span class=\"hljs-number\">_</span><span class=\"hljs-keyword\">value</span> = <span class=\"hljs-number\">2.5f</span>;\n\nauto a<span class=\"hljs-number\">_</span><span class=\"hljs-keyword\">value</span> = i<span class=\"hljs-number\">_</span><span class=\"hljs-keyword\">value</span> * f<span class=\"hljs-number\">_</span><span class=\"hljs-keyword\">value</span>;\ncout &#x3C;&#x3C; typeid(a<span class=\"hljs-number\">_</span><span class=\"hljs-keyword\">value</span>).name() &#x3C;&#x3C; <span class=\"hljs-string\">\": \"</span> &#x3C;&#x3C; a<span class=\"hljs-number\">_</span><span class=\"hljs-keyword\">value</span> &#x3C;&#x3C; endl;</code></pre>\n\n<p><strong>Compiler</strong> xác định kiểu dữ liệu float cho biến a_value, nhưng giá trị in ra là 25 chứ không phải 25.0 như biến <strong>float</strong> thông thường.</p>\n\n<p>Vì thế, các bạn cần cân nhắc trước khi sử dụng những từ khóa này.</p>\n\n<hr>\n\n<p><strong>Hẹn gặp lại các bạn trong bài học tiếp theo trong khóa học lập trình C++ hướng thực hành.</strong></p>\n\n<p>Mọi ý kiến đóng góp hoặc thắc mắc có thể đặt câu hỏi trực tiếp tại diễn đàn </p>\n\n<p><a title=\"DayNhauHoc\" class=\"onebox\" target=\"_blank\">www.daynhauhoc.com</a></p>\n\n<hr>\n\n<h3>Link Videos khóa học</h3>\n\n<p><a href=\"https://www.udemy.com/c-co-ban-danh-cho-nguoi-moi-hoc-lap-trinh/learn/v4/overview\" class=\"onebox\" target=\"_blank\" rel=\"nofollow\">https://www.udemy.com/c-co-ban-danh-cho-nguoi-moi-hoc-lap-trinh/learn/v4/overview</a></p>\n</body></html>","__filename":"generated/30020.md","__url":"/4/3-auto-va-decltype/","__resourceUrl":"/4/3-auto-va-decltype/index.html","__dataUrl":"/4/3-auto-va-decltype/index.html.0d8f1c6d9c4f8f1eff25628a38272254.json"}